!function(c){AstraWidgets={init:function(){this._init_colorpicker(),this._init_repeater(),this._bind()},_init_colorpicker:function(){c(".astra-widget-field-color input").wpColorPicker({change:function(e,t){}})},_bind:function(){c(document).on("widget-updated widget-added",AstraWidgets._reinit_controls),c(document).on("click",".astra-select-icon",AstraWidgets._icon_selector),c(document).on("click",".astra-widget-icon",AstraWidgets._set_icon),c(document).on("click",".astra-repeater-sortable .clone",AstraWidgets._repeater_clone),c(document).on("click",".astra-repeater-sortable .remove",AstraWidgets._repeater_remove),c(document).on("click",".astra-repeater-field .actions",AstraWidgets._repeater_toggle_open),c(document).on("click",".astra-repeater .add-new-btn",AstraWidgets._add_new),c(document).on("click",".widget-control-save",AstraWidgets._repeater_reinit),c(document).on("click",".astra-repeater-field .astra-select-image",AstraWidgets._repeater_add_image_field),c(document).on("click",".astra-repeater-field .astra-remove-image",AstraWidgets._repeater_remove_image_field),c(document).on("input",'.astra-repeater-field [data-field-id="title"]',AstraWidgets._repeater_set_title),c(document).on("keyup",".astra-repeater-field .search-icon",AstraWidgets._searchFuntionality)},_reinit_controls:function(){AstraWidgets._init_colorpicker(),AstraWidgets._init_repeater()},_icon_selector:function(e){c(this).parents(".astra-widget-icon-selector").find(".astra-icons-list-wrap").slideToggle()},_set_icon:function(e){var t=c(this).parents(".astra-widget-icon-selector"),a=c(this).attr("data-font")||"",i=t.find(".astra-widget-icon."+a),r=t.find(".astra-selected-icon"),s=t.find(".selected-icon"),n=c(this).attr("data-path"),d=c(this).attr("data-viewbox"),l=i.html();r.html(l),t.find(".astra-widget-icons-list .astra-widget-icon").removeClass("selected"),i.addClass("selected"),"yes"===c(this).closest(".astra-repeater-field").find(".selected-icon").data("icon-visible")&&(c(this).closest(".astra-repeater-field").find(".title").attr("class","title"),c(this).closest(".astra-repeater-field").find(".title").addClass(a)),iconObj={name:a,path:n,viewbox:d};var o=JSON.stringify(iconObj);s.val(o),t.find(".selected-icon").trigger("change")},_searchFuntionality:function(){var e,t,a,i;for(e=this.value.toUpperCase(),t=c(this).parent(".astra-icons-list-wrap").find(".astra-widget-icons-list")[0].getElementsByTagName("li"),i=0;i<t.length;i++)(a=c(t[i]).data("search-terms"))&&(-1<a.toUpperCase().indexOf(e)?t[i].style.display="":t[i].style.display="none")},_repeater_remove_image_field:function(e){if(confirm("Do you want to remove this image?")){var t=c(this).parents(".astra-repeater-field");t.find(".astra-field-image-preview").html(""),t.find(".astra-field-image-preview img").attr("src",""),t.find(".astra-field-image-preview-id").val(""),t.find(".astra-image-url").val(""),t.find(".astra-image-alt").val(""),t.find(".astra-image-title").val(""),t.find(".astra-image-size-select, .astra-image-width").hide()}},_repeater_add_image_field:function(e){var a=c(this).parents(".astra-repeater-field"),i=wp.media({title:"Select or Upload Image",button:{text:"Choose Image"},library:{type:"image"},multiple:!1});return i.on("close",function(){var e=i.state().get("selection").toJSON();if(!c.isEmptyObject(e)){if(e[0].sizes.hasOwnProperty("medium"))var t=e[0].sizes.medium.url;else if(e[0].sizes.hasOwnProperty("thumbnail"))t=e[0].sizes.thumbnail.url;else t=e[0].sizes.full.url;0<a.find(".astra-remove-image").length?a.find(".astra-field-image-preview img").attr("src",t):a.find(".astra-field-image-preview").append('<span class="astra-remove-image button">Remove</span><img src="'+t+'" />'),a.find(".astra-image-url").val(e[0].url),a.find(".astra-image-alt").val(e[0].alt),a.find(".astra-image-title").val(e[0].title),a.find(".astra-field-image-preview-id").val(e[0].id),a.find(".astra-image-size-select, .astra-image-width").show(),a.find("input").trigger("change")}}),i.open(),!1},_get_sub_string:function(e){var t="";if(24<e.length)t="..";return e=e.substring(0,24)+t},_repeater_set_title:function(e){var t=c(this).val()||"";t=AstraWidgets._get_sub_string(t),c(this).closest(".astra-repeater-field").find(".title").text(t)},_repeater_reinit:function(e){c(".astra-repeater-sortable").sortable()},_add_new:function(e){e.preventDefault();var t=c(this).closest(".astra-repeater"),a=c(".astra-repeater-field").length||0,i=t.find(".astra-repeater-fields").html(),r=t.find(".astra-repeater-fields").attr("title")||"",s=(t.find(".astra-repeater-fields").attr("data-id"),'<div class="astra-repeater-field">');s+='\t<div class="actions">',s+='\t<span class="index">'+a+"</span>",s+='\t\t<span class="dashicons dashicons-move"></span>',s+='\t<span class="title">'+r+"</span>",s+='\t\t<span class="dashicons dashicons-admin-page clone"></span>',s+='\t\t<span class="dashicons dashicons-trash remove"></span>',s+="\t</div>",s+='\t<div class="markukp">',s+=i=i.replace("][][","]["+a+"]["),s+="\t</div>",s+="</div>",t.find(".astra-repeater-sortable").append(s),AstraWidgets._set_repeater_names()},_set_repeater_names:function(){c(".astra-repeater").each(function(e,t){var n=c(t).find(".astra-repeater-fields").attr("data-id")||"";c(t).find(".astra-repeater-sortable").find(".astra-repeater-field").each(function(r,s){c(s).find(":input").each(function(e,t){var a=c(t).attr("data-field-id")||"",i=n+"["+r+"]["+a+"]";c(s).find(".index").text(r),c(t).attr("name",i)})})})},_repeater_toggle_open:function(e){e.preventDefault(),(e.target===this||c(e.target).hasClass("title")||c(e.target).hasClass("dashicons-move"))&&c(this).parents(".astra-repeater-field").find(".markukp").slideToggle()},_repeater_clone:function(e){e.preventDefault();var t=c(this),a=t.closest(".astra-repeater");a.find(".astra-repeater-fields").html();c(t).closest(".astra-repeater-field").clone().insertAfter(t.closest(".astra-repeater-field")),c(".astra-repeater-sortable").sortable(),a.find("input").trigger("change"),AstraWidgets._set_repeater_names()},_repeater_remove:function(e){e.preventDefault();var t=c(this),a=t.closest(".astra-repeater"),i=t.parent().find(".title").html(),r="";r=0<i.length?i:"this field",confirm("Are you sure you want to delete "+r+"?")&&t.closest(".astra-repeater-field").remove(),AstraWidgets._set_repeater_names(),a.find("input").trigger("change")},_init_repeater:function(){c(".astra-repeater-sortable").sortable({cursor:"move",stop:function(e,t){AstraWidgets._set_repeater_names(),t.item.find("input").trigger("change")}}),AstraWidgets._set_repeater_names(),c(".astra-repeater-field").length&&c(".astra-repeater-field").each(function(e,t){var a=c(t).find('[data-field-id="title"]').val()||"",i=c(t).find('[data-field-id="icon"]').val()||"";a=AstraWidgets._get_sub_string(a),c(t).find(".title").text(a),"yes"===c(t).find(".selected-icon").data("icon-visible")&&c(t).find(".title").addClass(i)})}},c(function(){AstraWidgets.init()})}(jQuery);